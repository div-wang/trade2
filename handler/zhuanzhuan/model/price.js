/*
 * @Author: Div gh110827@gmail.com
 * @Date: 2025-12-01 16:04:49
 * @LastEditors: Div gh110827@gmail.com
 * @LastEditTime: 2025-12-01 23:06:22
 * @Description:
 * Copyright (c) 2025 by ${git_name_email}, All Rights Reserved.
 */
const { modifySheetData, insertSheetData } = require("../../feishu");
const zhuanzhuan = require("../index");

const modelStorages = {
  2188: ["64G", "256G", "512G"],
  2189: ["64G", "128G", "256G"],
  2193: ["64G", "128G", "256G"],
  31458: ["64G", "128G", "256G"],
  31459: ["128G", "256G", "512G"],
  31469: ["128G", "256G", "512G"],
  31940: ["8G+128G", "8G+256G", "8G+512G"],
  58383: ["128G", "256G", "512G"],
  58384: ["128G", "256G", "512G"],
  58386: ["128G", "256G", "512G", "1T"],
  58387: ["128G", "256G", "512G", "1T"],
  95637: ["128G", "256G", "512G"],
  95638: ["128G", "256G", "512G", "1T"],
  95639: ["128G", "256G", "512G", "1T"],
  99971: ["8G+128G", "8G+256G", "12G+512G", "12G+256G"],
  125986: ["12G+512G", "12G+256G", "12G+1T"],
  129387: ["128G", "256G", "512G"],
  129388: ["128G", "256G", "512G", "1T"],
  129389: ["256G", "512G", "1T"],
  129390: ["128G", "256G", "512G"],
  147572: ["16G+1T", "8G+256G", "12G+256G", "16G+512G"],
  147650: ["16G+1T", "12G+256G", "16G+512G"],
  149129: ["16G+1T", "12G+512G", "12G+256G", "16G+512G"],
  151357: ["16G+1T", "12G+512G", "12G+256G", "16G+512G", "16G+256G"],
  259288: ["16G+1T", "12G+512G", "12G+256G", "16G+512G", "24G+1T"],
  381410: ["128G", "256G", "512G"],
  381411: ["128G", "256G", "512G", "1T"],
  381412: ["256G", "512G", "1T"],
  864926: ["16G+1T", "12G+256G", "16G+512G"],
  864927: ["16G+1T", "12G+512G", "12G+256G", "16G+512G"],
  869104: ["16G+1T", "12G+512G", "12G+256G", "16G+512G"],
  869105: ["16G+1T", "12G+256G", "16G+512G"],
  869521: ["16G+1T", "12G+512G", "12G+256G", "16G+512G", "16G+256G"],
  871227: ["16G+1T", "12G+512G", "12G+256G", "16G+512G", "16G+256G"],
  883529: ["16G+1T", "12G+512G", "12G+256G", "16G+512G", "16G+256G"],
  885631: ["16G+1T", "12G+512G", "12G+256G", "16G+512G", "16G+256G"],
  885710: ["16G+1T", "12G+512G", "12G+256G", "16G+512G"],
  912808: ["16G+1T", "12G+256G", "16G+512G"],
  934974: ["16G+1T", "12G+512G", "12G+256G", "16G+512G", "16G+256G"],
  937358: ["16G+1T", "12G+512G", "12G+256G", "16G+512G", "16G+256G"],
  971078: ["16G+1T", "12G+512G", "12G+256G", "16G+512G", "16G+256G"],
  1020252: ["16G+1T", "12G+512G", "12G+256G", "16G+512G"],
  38619: ["6G+128G", "8G+128G", "8G+256G", "12G+256G"],
  89082: ["8G+128G", "8G+256G", "12G+512G", "12G+256G"],
  89277: ["8G+128G", "8G+256G", "8G+512G"],
  91622: ["6G+128G", "8G+128G", "8G+256G", "8G+512G", "12G+256G"],
  95014: ["8G+128G", "8G+256G", "12G+512G", "12G+256G"],
  95605: ["8G+256G", "8G+512G"],
  99975: ["8G+128G", "8G+256G", "12G+512G", "12G+256G"],
  100543: [
    "16G+1T",
    "8G+128G",
    "8G+256G",
    "12G+512G",
    "12G+256G",
    "16G+512G",
    "16G+256G",
  ],
  102636: ["8G+256G", "12G+512G", "12G+256G", "12G+1T"],
  106600: ["16G+1T", "8G+128G", "8G+256G", "12G+512G", "12G+256G", "16G+256G"],
  112043: ["16G+1T", "12G+512G", "12G+256G", "16G+512G"],
  116031: ["8G+128G", "8G+256G", "12G+512G", "12G+256G", "16G+512G"],
  124515: ["16G+1T", "12G+256G", "16G+512G", "16G+256G", "24G+1T"],
  126364: ["12G+512G", "12G+256G", "12G+1T"],
  127851: ["12G+512G", "12G+256G", "16G+512G"],
  143508: ["8G+128G", "8G+256G", "12G+512G", "12G+256G", "16G+512G"],
  190198: ["16G+1T", "12G+256G", "16G+512G", "16G+256G"],
  222086: ["16G+1T", "12G+256G", "16G+512G"],
  240858: ["12G+512G", "12G+256G", "12G+1T"],
  240859: ["12G+512G", "12G+256G", "12G+1T"],
  241057: ["16G+1T", "12G+512G", "16G+512G"],
  242509: ["8G+128G", "8G+256G", "12G+512G", "12G+256G"],
  242510: ["12G+512G", "12G+256G", "16G+512G", "16G+256G"],
  259289: ["16G+1T", "12G+512G", "12G+256G"],
  529141: ["12G+512G", "12G+256G", "16G+512G", "16G+256G"],
  529434: ["4G+128G", "6G+128G", "8G+128G", "8G+256G", "12G+256G"],
  869002: ["12G+512G", "12G+256G", "16G+512G", "24G+1T"],
  870859: ["16G+1T", "12G+256G", "16G+512G"],
  877658: ["12G+512G", "12G+256G", "12G+1T"],
  877660: ["16G+1T", "16G+512G"],
  888493: ["4G+64G", "4G+128G", "6G+128G", "8G+256G"],
  894101: ["16G+1T", "12G+512G", "12G+256G", "16G+512G", "16G+256G"],
  923231: ["12G+512G", "12G+256G"],
  929450: ["16G+1T", "12G+512G", "12G+256G", "16G+512G", "16G+256G"],
  935101: ["16G+1T", "12G+512G", "12G+256G", "16G+512G", "16G+256G"],
  939889: ["12G+512G", "12G+256G", "16G+512G", "16G+256G"],
  949599: ["16G+1T", "12G+512G", "12G+256G", "16G+512G", "16G+256G"],
  954453: ["16G+1T", "12G+512G", "12G+256G", "16G+512G", "16G+256G"],
  1020253: ["16G+1T", "12G+512G", "16G+512G"],
};

const getModelPriceInfo = async (data) => {
  const config = Configs.zhuanzhuan.div;
  const zhuan = new zhuanzhuan(config);
  const { modelId, url, brandId } = data;
  const storages = modelStorages[modelId];
  let prices = {};
  for (let i = 0; i < storages.length; i++) {
    const storage = storages[i];
    const res = await zhuan.getGoodsList({ storage, modelId, brandId });
    const goodsList = res.respData && res.respData.datas;
    const price = goodsList[0].realPayPrice;
    prices[storage] = price;
    await Sleep();
  }
  return prices;
};

const app = async (list, index) => {
  for (let i = index || 0; i < list.length; i++) {
    const data = list[i];
    const priceData = await getModelPriceInfo(data);
    const newData = [JSON.stringify(priceData)];
    const { spreadsheet_token, sheet_id } = Configs.lark.zzRank;
    const range = "G" + data.index + ":" + "G" + data.index;
    await modifySheetData(spreadsheet_token, sheet_id, range, [newData]);
    await Sleep();
  }
};

module.exports = app;
